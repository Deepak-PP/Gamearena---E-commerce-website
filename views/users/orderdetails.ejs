<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
        <title>Add Product - Dashboard HTML Template</title>
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css?family=Roboto:400,700"/>
        <!-- https://fonts.google.com/specimen/Roboto -->
        <link
            rel="stylesheet"
            href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"/>
        <!-- https://fontawesome.com/ -->
        <link
            rel="stylesheet"
            href="jquery-ui-datepicker/jquery-ui.min.css"
            type="text/css"/>
        <!-- http://api.jqueryui.com/datepicker/ -->
        <link rel="stylesheet" href="/bootstrap.min.css"/>
        <!-- https://getbootstrap.com/ -->
        <link rel="stylesheet" href="/templatemo-style.css">
        <link rel="stylesheet" href="sweetalert2.min.css">
        <link
            rel="stylesheet"
            type="text/css"
            href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.2/dist/sweetalert2.min.css">
        <!-- Product Admin CSS Template https://templatemo.com/tm-524-product-admin -->
    </head>
    <style>
        @import url('https://fonts.googleapis.com/css?family=Open+Sans&display=swap');
        body {
            background-color: #eeeeee;
            font-family: 'Open Sans',serif;
        }
        .container {
            margin-top: 50px;
            margin-bottom: 50px;
        }
        .card {
            position: relative;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-orient: vertical;
            -webkit-box-direction: normal;
            -ms-flex-direction: column;
            flex-direction: column;
            min-width: 0;
            word-wrap: break-word;
            background-color: #fff;
            background-clip: border-box;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 0.10rem;
        }
        .card-header:first-child {
            border-radius: calc(0.37rem - 1px) calc(0.37rem - 1px) 0 0;
        }
        .card-header {
            padding: 0.75rem 1.25rem;
            margin-bottom: 0;
            background-color: #fff;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        .track {
            position: relative;
            background-color: #ddd;
            height: 7px;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            margin-bottom: 60px;
            margin-top: 50px;
        }
        .track .step {
            -webkit-box-flex: 1;
            -ms-flex-positive: 1;
            flex-grow: 1;
            width: 25%;
            margin-top: -18px;
            text-align: center;
            position: relative;
        }
        .track .step.active:before {
            background: #FF5722;
        }
        .track .step::before {
            height: 7px;
            position: absolute;
            content: "";
            width: 100%;
            left: 0;
            top: 18px;
        }
        .track .step.active .icon {
            background: #ee5435;
            color: #fff;
        }
        .track .icon {
            display: inline-block;
            width: 40px;
            height: 40px;
            line-height: 40px;
            position: relative;
            border-radius: 100%;
            background: #ddd;
        }
        .track .step.active .text {
            font-weight: 400;
            color: #000;
        }
        .track .text {
            display: block;
            margin-top: 7px;
        }
        .itemside {
            position: relative;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            width: 100%;
        }
        .itemside .aside {
            position: relative;
            -ms-flex-negative: 0;
            flex-shrink: 0;
        }
        .img-sm {
            width: 80px;
            height: 80px;
            padding: 7px;
        }
        ul.row,
        ul.row-sm {
            list-style: none;
            padding: 0;
        }
        .itemside .info {
            padding-left: 15px;
            padding-right: 7px;
        }
        .itemside .title {
            display: block;
            margin-bottom: 5px;
            color: #212529;
        }
        p {
            margin-top: 0;
            margin-bottom: 1rem;
        }
        .btn-warning {
            color: #ffffff;
            background-color: #ee5435;
            border-color: #ee5435;
            border-radius: 1px;
        }
        .btn-warning:hover {
            color: #ffffff;
            background-color: #ff2b00;
            border-color: #ff2b00;
            border-radius: 1px;
        }
        
    </style>

    <div class="container">
        <article class="card">
            <header class="card-header">
                My Orders / Tracking
            </header>
            <div class="card-body">
                <h6>Order ID:
                    <%=orderData._id%></h6>
                <article class="card">
                    <div class="card-body row">
                        <div class="col">
                            <strong>Estimated Delivery time:</strong>
                            <br>
                            <%=deliveryDate.toString().slice(0,16)%>
                        </div>

                        <div class="col">
                            <strong>Shipping BY:</strong>
                            <br>
                            BLUEDART, |
                            <i class="fa fa-phone"></i>
                            +1598675986
                        </div>
                        <div class="col">
                            <strong>Status:</strong>
                            <br><%=orderData.order_status%>
                        </div>
                        <div class="col">
                            <strong>Tracking #:</strong>
                            <br>
                            BD045903594059
                        </div>
                    </div>
                </article>
                <div class="track">
                    <% if(orderData.order_status=="pending"){ %>
                        <div class="step active">
                            <span class="icon">
                                <i class="fa fa-check"></i>
                            </span>
                            <span class="text">Pending</span>
                        </div>
                        <div class="step">
                            <span class="icon">
                                <i class="fa fa-user"></i>
                            </span>
                            <span class="text">
                                Placed</span>
                        </div>
                        <div class="step ">
                            <span class="icon">
                                <i class="fa fa-user"></i>
                            </span>
                            <span class="text">
                                Shipped</span>
                        </div>
                        <div class="step">
                            <span class="icon">
                                <i class="fa fa-truck"></i>
                            </span>
                            <span class="text">
                                Out for delivery
                            </span>
                        </div>
                        <div class="step">
                            <span class="icon">
                                <i class="fa fa-box"></i>
                            </span>
                            <span class="text">Delivered</span>
                        </div>
                        <div class="step">
                            <span class="icon">
                                <i class="fa fa-box"></i>
                            </span>
                            <span class="text">Cancelled</span>
                        </div>

                        <%  } else if(orderData.order_status=="Placed") { %>
                            <div class="step active">
                                <span class="icon">
                                    <i class="fa fa-check"></i>
                                </span>
                                <span class="text">Pending</span>
                            </div>
                            <div class="step active">
                                <span class="icon">
                                    <i class="fa fa-user"></i>
                                </span>
                                <span class="text">
                                    Placed</span>
                            </div>
                            <div class="step ">
                                <span class="icon">
                                    <i class="fa fa-user"></i>
                                </span>
                                <span class="text">
                                    Shipped</span>
                            </div>
                            <div class="step">
                                <span class="icon">
                                    <i class="fa fa-truck"></i>
                                </span>
                                <span class="text">
                                    Out for delivery
                                </span>
                            </div>
                            <div class="step">
                                <span class="icon">
                                    <i class="fa fa-box"></i>
                                </span>
                                <span class="text">Delivered</span>
                            </div>
                            <div class="step">
                                <span class="icon">
                                    <i class="fa fa-box"></i>
                                </span>
                                <span class="text">Cancelled</span>
                            </div>
                            <% } else if(orderData.order_status=="Shipped" ) { %>
                                <div class="step active">
                                    <span class="icon">
                                        <i class="fa fa-check"></i>
                                    </span>
                                    <span class="text">Pending</span>
                                </div>
                                <div class="step active">
                                    <span class="icon">
                                        <i class="fa fa-user"></i>
                                    </span>
                                    <span class="text">
                                        Placed</span>
                                </div>
                                <div class="step active">
                                    <span class="icon">
                                        <i class="fa fa-user"></i>
                                    </span>
                                    <span class="text">
                                        Shipped</span>
                                </div>
                                <div class="step">
                                    <span class="icon">
                                        <i class="fa fa-truck"></i>
                                    </span>
                                    <span class="text">
                                        Out for delivery
                                    </span>
                                </div>
                                <div class="step">
                                    <span class="icon">
                                        <i class="fa fa-box"></i>
                                    </span>
                                    <span class="text">Delivered</span>
                                </div>
                                <div class="step">
                                    <span class="icon">
                                        <i class="fa fa-box"></i>
                                    </span>
                                    <span class="text">Cancelled</span>
                                </div>
                                <% } else if(orderData.order_status=="Out for Delivery") { %>
                                    <div class="step active">
                                        <span class="icon">
                                            <i class="fa fa-check"></i>
                                        </span>
                                        <span class="text">Pending</span>
                                    </div>
                                    <div class="step active">
                                        <span class="icon">
                                            <i class="fa fa-user"></i>
                                        </span>
                                        <span class="text">
                                            Placed</span>
                                    </div>
                                    <div class="step active">
                                        <span class="icon">
                                            <i class="fa fa-user"></i>
                                        </span>
                                        <span class="text">
                                            Shipped</span>
                                    </div>
                                    <div class="step active">
                                        <span class="icon">
                                            <i class="fa fa-truck"></i>
                                        </span>
                                        <span class="text">
                                            Out for delivery
                                        </span>
                                    </div>
                                    <div class="step">
                                        <span class="icon">
                                            <i class="fa fa-box"></i>
                                        </span>
                                        <span class="text">Delivered</span>
                                    </div>
                                    <div class="step">
                                        <span class="icon">
                                            <i class="fa fa-box"></i>
                                        </span>
                                        <span class="text">Cancelled</span>
                                    </div>
                                    <% } else if(orderData.order_status=="Delivered") { %>
                                        <div class="step active">
                                            <span class="icon">
                                                <i class="fa fa-check"></i>
                                            </span>
                                            <span class="text">Pending</span>
                                        </div>
                                        <div class="step active">
                                            <span class="icon">
                                                <i class="fa fa-user"></i>
                                            </span>
                                            <span class="text">
                                                Placed</span>
                                        </div>
                                        <div class="step active">
                                            <span class="icon">
                                                <i class="fa fa-user"></i>
                                            </span>
                                            <span class="text">
                                                Shipped</span>
                                        </div>
                                        <div class="step active">
                                            <span class="icon">
                                                <i class="fa fa-truck"></i>
                                            </span>
                                            <span class="text">
                                                Out for delivery
                                            </span>
                                        </div>
                                        <div class="step active">
                                            <span class="icon">
                                                <i class="fa fa-box"></i>
                                            </span>
                                            <span class="text">Delivered</span>
                                        </div>
                                        <div class="step">
                                            <span class="icon">
                                                <i class="fa fa-box"></i>
                                            </span>
                                            <span class="text">Cancelled</span>
                                        </div>
                                        <% } else if(orderData.order_status=="Cancelled") { %>
                                            <div class="step active">
                                                <span class="icon">
                                                    <i class="fa fa-check"></i>
                                                </span>
                                                <span class="text">Pending</span>
                                            </div>
                                            <div class="step active">
                                                <span class="icon">
                                                    <i class="fa fa-user"></i>
                                                </span>
                                                <span class="text">
                                                    Placed</span>
                                            </div>
                                            <div class="step active">
                                                <span class="icon">
                                                    <i class="fa fa-user"></i>
                                                </span>
                                                <span class="text">
                                                    Shipped</span>
                                            </div>
                                            <div class="step active">
                                                <span class="icon">
                                                    <i class="fa fa-truck"></i>
                                                </span>
                                                <span class="text">
                                                    Out for delivery
                                                </span>
                                            </div>
                                            <div class="step active">
                                                <span class="icon">
                                                    <i class="fa fa-box"></i>
                                                </span>
                                                <span class="text">Delivered</span>
                                            </div>
                                            <div class="step active">
                                                <span class="icon">
                                                    <i class="fa fa-box"></i>
                                                </span>
                                                <span class="text">Cancelled</span>
                                            </div>
                                        <% } %>
                                    </div>
                                    <hr>
                                    <ul class="row">
                                        <%for(let i=0;i<orderData.products.length;i++){%>
                                            <li class="col-md-4">
                                                <figure class="itemside mb-3">
                                                    <div class="aside"><img
                                                        src="/productImages/<%= orderData.products[i].item[0].image[0] %>"
                                                        class="img-sm border"></div>
                                                    <figcaption class="info align-self-center">
                                                        <p class="title"><%= orderData.products[i].item[0].name %>
                                                            <br><%= orderData.products[i].item[0].hdd %></p>
                                                        <span class="text-muted">Rs
                                                            <%= orderData.products[i].item[0].price %>
                                                        </span>
                                                        <br>
                                                        <% if(orderData.order_status=="Delivered" ){ %>
                                                            <a
                                                                onclick="returnProduct('<%= orderData.products[i]._id %>','<%= orderData._id %>',event)"
                                                                class="btn btn-warning"
                                                                data-abc="true">
                                                                <i class="fa fa-chevron-left"></i>
                                                                Return Product</a>
                                                        <% } %>
                                                    </figcaption>
                                                </figure>
                                            </li>
                                        <%}%>

                                    </ul>
                                    <hr>
                                    <a href="/orderhistory" class="btn btn-warning" data-abc="true">
                                        <i class="fa fa-chevron-left"></i>
                                        Back to orders</a>
           

                                </div>
                            </article>
                        </div>
                    </html>

                    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
                    <script
                        src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>
                    <script src="sweetalert2.all.min.js"></script>

                    <script>

                        function returnProduct(prodId, orderId, event) {
                            event.preventDefault(); // prevent form submit
                            // storing the form
                            swal({
                                title: "Are you sure?",
                                text: "You are about to return your product",
                                type: "warning",
                                showCancelButton: true,
                                confirmButtonColor: "#d33",
                                cancelButtonColor: "#DD6B55",
                                confirmButtonText: "Yes, cancel order",
                                cancelButtonText: "No, Abort!",
                                closeOnConfirm: true,
                                closeOnCancel: false
                            }, function (isConfirm) {
                                if (isConfirm) {

                                    $.ajax({
                                        url: '/walletAdd/',
                                        method: "post",
                                        data: ({prodId, orderId}),
                                        success: function (response) {

                                            if (response.success == true) {
                                                setTimeout(() => {
                                                    alert("Product return initiated")

                                                }, 500)
                                            }
                                        }
                                    });
                                } else {
                                    swal("Cancelled", "Your Order is safe", "error");
                                }
                            })
                        }
                    </script>